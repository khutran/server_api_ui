<div class="x_panel">
	<div class="dataTables_wrapper">
		<div class="x_content">
			<div class="row">
				<div class="col-md-12 col-sm-12 col-12 ">
					<div class="breadcrumb-section">
						<ul class="breadcrumb">
							<li>
								<a routerLink="/">Home</a>
							</li>
							<li>
								<a routerLink="/product">Order</a>
							</li>
							<li *ngIf="store.getState().Order.detail.fetched">Order #{{ store.getState().Order.detail.data.id }}</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div *ngIf="store.getState().Order.detail.fetched">

	<form>

		<div class="row">
			<div class="col-md-12 col-sm-12 col-12 ">
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Items Ordered
						</h4>
					</div>
					<div class="x_content">
						<table class="table">
							<thead>
								<tr>
									<th></th>
									<th>Product</th>
									<th>Location</th>
									<th>Original Price</th>
									<th>Price</th>
									<th>Qty</th>
								</tr>
							</thead>
							<tbody *ngIf="store.getState().Order.detail.data.products | hasItem">
								<tr *ngFor="let item of store.getState().Order.detail.data.products">
									<td>
										<img src="{{ store.getState().RootReducer.config.mediaUrl }}" alt="{{ item.sku }}" />
									</td>
									<td>
										<span *ngIf="item.name">
											{{ item.getName() }}
										</span>
									</td>
									<td>
										<span *ngIf="item.location">{{ item.location.name }}</span>
									</td>
									<td>
										<span *ngIf="item.original_price">
											{{ item.getOriginalPrice() | currency:'SGD' }}
										</span>
									</td>
									<td>
										<span *ngIf="item.price">
											{{ item.getPrice() | currency:'SGD' }}
										</span>
									</td>
									<td>
										<span *ngIf="item.order_product">
											{{ item.getOrderProduct().getQuantity() }}
										</span>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-6 col-sm-6 col-xs-6">
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Billing Address
						</h4>
					</div>
					<div class="x_content">
						<div *ngIf="store.getState().Order.detail.data.billing_address">
							<p>{{ store.getState().Order.detail.data.getBillingAddress().address_1 }}</p>
							<p>{{ store.getState().Order.detail.data.getBillingAddress().address_2 }}</p>
							<p>{{ store.getState().Order.detail.data.getBillingAddress().city }}, {{ store.getState().Order.detail.data.getBillingAddress().state
								}}, {{ store.getState().Order.detail.data.getBillingAddress().zipcode }}</p>
							<p>{{ store.getState().Order.detail.data.getBillingAddress().country }}</p>
							<p>{{ store.getState().Order.detail.data.getBillingAddress().phone }}</p>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-6 col-sm-6 col-xs-6">
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Shipping Address
						</h4>
					</div>
					<div class="x_content">
						<div *ngIf="store.getState().Order.detail.data.shipping_address">
							<p>{{ store.getState().Order.detail.data.getShippingAddress().address_1 }}</p>
							<p>{{ store.getState().Order.detail.data.getShippingAddress().address_2 }}</p>
							<p>{{ store.getState().Order.detail.data.getShippingAddress().city }}, {{ store.getState().Order.detail.data.getShippingAddress().state
								}}, {{ store.getState().Order.detail.data.getShippingAddress().zipcode }}</p>
							<p>{{ store.getState().Order.detail.data.getShippingAddress().country }}</p>
							<p>{{ store.getState().Order.detail.data.getShippingAddress().phone }}</p>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-6 col-sm-6 col-12 ">
				<div class="x_panel">
					<div class="x_title">
						<h4>Order #{{ store.getState().Order.detail.data.getId() }}
							<small> (the order confirmation email was sent)</small>
						</h4>
					</div>
					<div class="x_content">
						<table class="table">
							<tr>
								<td>Order Date</td>
								<td>{{ store.getState().Order.detail.data.getUpdated().format('ll') }}</td>
							</tr>
							<tr>
								<td>Order Status</td>
								<td>{{ store.getState().Order.detail.data.getStatus() }}</td>
							</tr>
						</table>
					</div>
				</div>
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Customer Comment
						</h4>
					</div>
					<div class="x_content">
						<i class="fa fa-comment"></i> {{ store.getState().Order.detail.data.notes }}
					</div>
				</div>
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Change order status
						</h4>
					</div>
					<div class="x_content">
						<p>Order Status</p>
						<p>
							<select class="form-control input-sm" name="order_status" [(ngModel)]="store.getState().Order.detail.data.status">
								<option value="">--status--</option>
								<option value="canceled">Canceled</option>
								<option value="closed">Closed</option>
								<option value="complete">Complete</option>
								<option value="fraud">Suspected Fraud</option>
								<option value="holded">On Hold</option>
								<option value="payment_review">Payment Review</option>
								<option value="pending">Pending</option>
								<option value="pending_payment">Pending Payment</option>
								<option value="pending_paypal">Pending PayPal</option>
								<option value="processing">Processing</option>
							</select>
						</p>
						<button class="btn btn-success btn-xs" (click)="onSubmit()">Change</button>
					</div>
				</div>
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Payment Information
						</h4>
					</div>
					<div class="x_content">
						<i class="fa fa-credit-card"></i> {{ store.getState().Order.detail.data.payment_method }}
					</div>
				</div>
			</div>
			<div class="col-md-6 col-sm-6 col-12 ">
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Change Courier
						</h4>
					</div>
					<div class="x_content">
						<table class="table">
							<tr>
								<td>Shipping Method</td>
								<td>
									<select class="form-control input-sm" name="shipping_method" [(ngModel)]="store.getState().Order.detail.data.delivery_method">
										<option value="">Select</option>
										<option value="aramex">Aramex</option>
										<option value="dhl">DHL</option>
										<option value="tablerate_bestway">Table Rate</option>
										<option value="freeshipping_freeshipping">Fee Ship</option>
										<option value="flatrate_flatrate">Flat Rate</option>
										<option value="ups_GND">USP Ground</option>
										<option value="matrixrate">Matrix Rate</option>
									</select>
								</td>
							</tr>
							<tr>
								<td>Tracking Number</td>
								<td>
									<input type="text" class="form-control input-sm" name="tracking_number" [(ngModel)]="store.getState().Order.detail.data.shipping_tracking_number">
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<button class="btn btn-success btn-xs" (click)="onSubmit()">Change</button>
								</td>
							</tr>
						</table>
					</div>
				</div>
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Account Information
						</h4>
					</div>
					<div class="x_content">
						<table class="table">
							<tr>
								<td>Customer Name</td>
								<td>
									<span *ngIf="store.getState().Order.detail.user">
										{{ store.getState().Order.detail.user.getCustomer().getFullName() }}
									</span>
									<span *ngIf="!store.getState().Order.detail.user">
										Guest
									</span>
								</td>
							</tr>
							<tr>
								<td>Email</td>
								<td>
									<a *ngIf="store.getState().Order.detail.user" href="{{ store.getState().Order.detail.user.getEmail() }}">
										{{ store.getState().Order.detail.user.getEmail() }}
									</a>
									<span *ngIf="store.getState().Order.detail.user === undefined">
										None
									</span>
								</td>
							</tr>
							<tr>
								<td>Customer Group</td>
								<td>
									<span *ngIf="store.getState().Order.detail.user">
										{{ store.getState().Order.detail.user.getCustomer().getGroup() }}
									</span>
								</td>
							</tr>
						</table>
					</div>
				</div>
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Delivery Date
						</h4>
					</div>
				</div>
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Shipping & Handling Information
						</h4>
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-6 col-sm-6 col-12 ">
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Comments History
						</h4>
					</div>
					<div class="x_content">
						<p>Add Order Comments</p>
						<p>
							<textarea class="form-control" cols="30" rows="10" name="order_note" [(ngModel)]="store.getState().Order.detail.data.notes"></textarea>
						</p>
						<button class="btn btn-success btn-xs" (click)="onSubmit()">Submit Comment</button>
					</div>
				</div>
			</div>
			<div class="col-md-6 col-sm-6 col-12 ">
				<div class="x_panel">
					<div class="x_title">
						<h4>
							Order Totals
						</h4>
					</div>
					<div class="x_content">
						<table class="table">
							<tr>
								<td>Subtotal</td>
								<td>
									{{ store.getState().Order.detail.data.getSubTotal() | currency:'SGD' }}
								</td>
							</tr>
							<tr>
								<td>Shipping & Handling</td>
								<td>
									{{ 0 | currency:'SGD' }}
								</td>
							</tr>
							<tr>
								<td>
									<b>Grand Total</b>
								</td>
								<td>
									<b>{{ store.getState().Order.detail.data.getTotal() | currency:'SGD' }}</b>
								</td>
							</tr>
							<tr>
								<td>
									<b>Total Paid</b>
								</td>
								<td>
									<b>{{ store.getState().Order.detail.data.getTotalPaid() | currency:'SGD' }}
									</b>
								</td>
							</tr>
							<tr>
								<td>
									<b>Total Refunded</b>
								</td>
								<td>
									<b>{{ store.getState().Order.detail.data.getTotalRefund() | currency:'SGD' }}
									</b>
								</td>
							</tr>
							<tr>
								<td>
									<b>Total Due</b>
								</td>
								<td>
									<b>{{ store.getState().Order.detail.data.getTotalDue() | currency:'SGD' }}
									</b>
								</td>
							</tr>
						</table>
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12 col-sm-12 col-12 ">
				<swal #popup title="Delete Order" text="Do you want to delete this order?" type="warning" [showCancelButton]="true" (confirm)="deleteOrder(store.getState().Order.detail.data.id)"></swal>
				<button class="btn btn-danger" [swal]="popup">
					<i class="fa fa-trash"></i>
					Detele
				</button>
			</div>
		</div>

	</form>
</div>